#!/usr/bin/bpftrace

tracepoint:raw_syscalls:sys_enter
/comm == "python2"/
{
    printf("%s[%d] called syscall %d\n", comm, pid, args->id);
}


tracepoint:sched:sched_process_fork
/comm == str($1)/
{
    printf("%s[%d] forked %s[%d] child comm:%s child pid:%d\n", comm, pid, args->parent_comm, args->parent_pid,args->child_comm, args->child_pid);
}

tracepoint:sched:sched_process_exec
/comm == str($1)/
{
    printf("%s[%d] executed %d[%d]\n", comm, pid, args->old_pid, args->pid);
}
